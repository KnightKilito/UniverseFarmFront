<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link href="css/common.css" rel="stylesheet" type="text/css"/>
    <link href="css/style.css" rel="stylesheet" type="text/css"/>
    <link href="css/user_style.css" rel="stylesheet" type="text/css"/>
    <link href="skins/all.css" rel="stylesheet" type="text/css"/>
    <script src="js/jquery-1.8.3.min.js" type="text/javascript"></script>
    <script src="js/jquery.SuperSlide.2.1.1.js" type="text/javascript"></script>
    <script src="js/common_js.js" type="text/javascript"></script>
    <script src="js/footer.js" type="text/javascript"></script>
    <script src="layer/layer.js" type="text/javascript"></script>
    <script src="js/iCheck.js" type="text/javascript"></script>
    <script src="js/custom.js" type="text/javascript"></script>
    <title>用户信息</title>

    <script>
        //当文档加载完毕时触发
        $(document).ready(function () {
            //加载当前的登录用户
            $.ajax({
                url: "http://localhost:8088/UniverseFarmBack/getLoginUser.do",
                dataType: "json",
                type: "get",
                xhrFields: {                               //保存session在跨域访问中不会丢失！！！
                    withCredentials: true
                },
                crossDomain: true,
                success: function (result) {
                    if (result.flag == 0) {
                        alert(result.msg);
                        location.href = "login.html";
                    } else {
                        //取出里面用户对象
                        var user = result.data;
                        $("#myuserid").val(user.user_id);  //用户id
                        $("#userlname").val(user.user_lname);
                        $("#userrname").val(user.user_rname);
                        $("#useraddress").val(user.user_address);
                        $("#userphone").val(user.user_phone);
                        $("#userphoto").val(user.user_photo);

                        //将用户信息填充到页面上
                        $("#userlname").html(result.data.userAccount);
                        var input = document.getElementById("userlname");  //获取input对象
                        input.setAttribute("value", result.data.userAccount);  //为input对象设置value属性和值
                        $("#userrname").html(result.data.userName);
                        input = document.getElementById("userrname");
                        input.setAttribute("value", result.data.userName);
                        $("#useraddress").html(result.data.userAddressed);
                        $("#userphone").html(result.data.userPhone);
                        $("#userintegral").html(result.data.userIntegral);
                        if(user.user_photo==null){
                            $("#userphoto").html("<img src='images/avatar/people.png'/>");
                        }else {
                            $("#userphoto").html("<img src='images/avatar"+result.data.userPhoto+"'/>");
                        }

                        var str = "";
                        if (user.user_sex == "男") {
                            //男被选择
                            str = '<span id="usersex"><input type="radio"  name="sex" value="保密">保密<input type="radio" name="sex" checked="checked" value="男">男<input type="radio" name="sex" value="女">女</span>';
                        } else if (user.user_sex == "女") {
                            //选中女
                            str = '<span id="usersex"><input type="radio"  name="sex" value="保密">保密<input type="radio" name="sex" value="男">男<input type="radio" name="sex" checked="checked" value="女">女</span>';
                        } else {
                            //选中保密
                            str = '<span id="usersex"><input type="radio" checked="checked" name="sex" value="保密">保密<input type="radio" name="sex" value="男">男<input type="radio" name="sex" value="女">女</span>';
                        }
                        $("#usersex").html(str);


                    }

                }
            });


        });


    </script>
    <script>
        function myupdate() {
            //  角色不用修改，登录名不用修改，积分不用修改
            //获取要修改数据
            var userid = $("#myuserid").val();
            var username = $("#userrname").val();
            var birthday = $("#userbirthday").val();
            var email = $("#useremail").val()
            var tel = $("#usertel").val();
            var list = $("#usersex input");
            var sex = null;
            var i = 0;
            for (i; i < list.length; i++) {
                if (list[i].checked) {
                    sex = list[i].value;
                }
            }
            //调用ajax  将要修改的用户信息传入后端控制器
            $.ajax({
                url: "http://localhost:8088/UniverseFarmBack/updateUser.do",
                dataType: "json",
                type: "get",
                data: {
                    userid: userid,
                    userrname: username,
                    birthday: birthday,
                    email: email,
                    tel: tel,
                    sex: sex
                },
                xhrFields: {                               //保存session在跨域访问中不会丢失！！！
                    withCredentials: true
                },
                crossDomain: true,
                success: function (result) {
                    if (result.flag == 0) {
                        //修改失败
                        alert(result.msg);
                    } else {
                        //修改成功
                        alert(result.msg);
                    }
                }

            });


        }
    </script>

</head>

<body>
<head>
    <div id="header_top">
        <div id="top">
            <div class="Inside_pages">
                <!--<div class="Collection"><a href="#" class="green">请登录</a> <a href="#" class="green">免费注册</a></div>-->
                <div class="hd_top_manu clearfix">
                    <ul class="clearfix">
                        <li class="hd_menu_tit" data-addclass="hd_menu_hover"><a href="#">首页</a></li>
                        <li class="hd_menu_tit" data-addclass="hd_menu_hover"><a href="#">我的小充</a></li>
                        <li class="hd_menu_tit" data-addclass="hd_menu_hover"><a href="#">消息中心</a></li>
                        <li class="hd_menu_tit" data-addclass="hd_menu_hover"><a href="#">商品分类</a></li>
                        <li class="hd_menu_tit" data-addclass="hd_menu_hover"><a href="#">我的购物车<b>(23)</b></a></li>
                    </ul>
                </div>
            </div>
        </div>
        <div id="header" class="header page_style">
            <div class="logo"><a href="oldindex.html"><img src="images/logo.png"/></a></div>
            <!--结束图层-->
            <div class="Search">
                <div class="search_list">
                    <ul>
                        <li class="current"><a href="#">产品</a></li>
                        <li><a href="#">信息</a></li>
                    </ul>
                </div>
                <div class="clear search_cur">
                    <input name="searchName" id="searchName" class="search_box" onkeydown="keyDownSearch()" type="text">
                    <input name="" type="submit" value="搜 索" class="Search_btn"/>
                </div>
                <div class="clear hotword">热门搜索词：香醋&nbsp;&nbsp;&nbsp;茶叶&nbsp;&nbsp;&nbsp;草莓&nbsp;&nbsp;&nbsp;葡萄&nbsp;&nbsp;&nbsp;菜油</div>
            </div>
            <!--购物车样式-->
            <div class="hd_Shopping_list" id="Shopping_list">
                <div class="s_cart"><a href="#">我的购物车</a> <i class="ci-right">&gt;</i><i class="ci-count"
                                                                                         id="shopping-amount">0</i>
                </div>
                <div class="dorpdown-layer">
                    <div class="spacer"></div>
                    <!--<div class="prompt"></div><div class="nogoods"><b></b>购物车中还没有商品，赶紧选购吧！</div>-->
                    <ul class="p_s_list">
                        <li>
                            <div class="img"><img src="images/tianma.png"></div>
                            <div class="content"><p class="name"><a href="#">产品名称</a></p>
                                <p>颜色分类:紫花8255尺码:XL</p></div>
                            <div class="Operations">
                                <p class="Price">￥55.00</p>
                                <p><a href="#">删除</a></p></div>
                        </li>
                    </ul>
                    <div class="Shopping_style">
                        <div class="p-total">共<b>1</b>件商品　共计<strong>￥ 515.00</strong></div>
                        <a href="Shop_cart.html" title="去购物车结算" id="btn-payforgoods" class="Shopping">去购物车结算</a>
                    </div>
                </div>
            </div>
        </div>
        <!--菜单栏-->
        <div class="Navigation" id="Navigation">
            <ul class="Navigation_name">
                <li><a href="Home.html">首页</a></li>
                <li><a href="#">你身边的超市</a></li>
                <li><a href="#">预售专区</a><em class="hot_icon"></em></li>
                <li><a href="products_list.html">商城</a></li>
                <li><a href="#">半小时生活圈</a></li>
                <li><a href="#">好评商户</a></li>
                <li><a href="#">热销活动</a></li>
                <li><a href="Brands.html">联系我们</a></li>
            </ul>
        </div>
        <script>$("#Navigation").slide({titCell: ".Navigation_name li", trigger: "click"});</script>
    </div>
</head>
<!--用户中心样式-->
<div class="user_style clearfix">
    <div class="user_center clearfix">
        <!--左侧样式-->
        <div class="left_style">
            <div class="menu_style">
                <div class="user_title">用户中心</div>
                <div class="user_Head">
                    <div class="user_portrait">
                        <a href="#" title="修改头像" class="btn_link"></a> <img src="images/people.png">
                        <div class="background_img"></div>
                    </div>
                    <div class="user_name">
                        <p><span class="name">化海天堂</span><a href="#">[修改密码]</a></p>
                        <p>访问时间：2016-1-21 10:23</p>
                    </div>
                </div>
                <div class="sideMen">
                    <!--菜单列表图层-->
                    <dl class="accountSideOption1">
                        <dt class="transaction_manage"><em class="icon_1"></em>订单管理</dt>
                        <dd>
                            <ul>
                                <li><a href="用户中心-我的订单.html">我的订单</a></li>
                                <li><a href="用户中心-收货地址.html">收货地址</a></li>
                                <li><a href="#">缺货登记</a></li>
                                <li><a href="#">跟踪包裹</a></li>
                            </ul>
                        </dd>
                    </dl>
                    <dl class="accountSideOption1">
                        <dt class="transaction_manage"><em class="icon_2"></em>会员管理</dt>
                        <dd>
                            <ul>
                                <li><a href="用户中心-用户信息.html"> 用户信息</a></li>
                                <li><a href="用户中心-我的收藏.html"> 我的收藏</a></li>
                                <li><a href="#"> 我的留言</a></li>
                                <li><a href="#">我的标签</a></li>
                                <li><a href="#"> 我的推荐</a></li>
                                <li><a href="#"> 我的评论</a></li>
                            </ul>
                        </dd>
                    </dl>
                    <dl class="accountSideOption1">
                        <dt class="transaction_manage"><em class="icon_3"></em>账户管理</dt>
                        <dd>
                            <ul>
                                <li><a href="用户中心-账户管理.html">账户余额</a></li>
                                <li><a href="用户中心-消费记录.html">消费记录</a></li>
                                <li><a href="#">资金管理</a></li>
                            </ul>
                        </dd>
                    </dl>
                    <dl class="accountSideOption1">
                        <dt class="transaction_manage"><em class="icon_4"></em>分销管理</dt>
                        <dd>
                            <ul>
                                <li><a href="#">店铺管理</a></li>
                                <li><a href="#">我的盟友</a></li>
                                <li><a href="#">我的佣金</a></li>
                                <li><a href="#">申请提现</a></li>
                            </ul>
                        </dd>
                    </dl>
                </div>
                <script>jQuery(".sideMen").slide({
                    titCell: "dt",
                    targetCell: "dd",
                    trigger: "click",
                    defaultIndex: 0,
                    effect: "slideDown",
                    delayTime: 300,
                    returnDefault: true
                });</script>
            </div>
        </div>
        <!--右侧样式-->
        <div class="right_style">
            <!--消费记录样式-->
            <div class="user_address_style">
                <div class="title_style"><em></em>用户信息</div>
                <!--用户信息样式-->
                <!--个人信息-->
                <div class="Personal_info" id="Personal">
                    <ul class="xinxi"><input type="hidden" id="myuserid">
                        <li><label>用户名：</label> <span><input id="userlname" name="" type="text" value="" class="text"
                                                             disabled="disabled"/></span></li>
                        <li><label>真实姓名：</label> <span><input id="userrname" name="" type="text" value=""
                                                              class="text add"/></span></li>
                        <li><label>联系电话：</label> <span><input id="userphone" name="" type="text" value=""
                                                              class="text add"/></span></li>
                        <li><label>收货地址：</label> <span><input id="useraddress" name="" type="text" value=""
                                                              class="text add"/></span></li>
                        <div class="bottom"><input name="" type="reset" value="重置" class="modify"/><input name=""
                                                                                                          type="button"
                                                                                                          value="确认修改"
                                                                                                          class="confirm"
                                                                                                          onclick="myupdate()"/>
                        </div>
                    </ul>
                    <ul class="Head_portrait">
                        <li class="User_avatar" id="userphoto"></li>
                        <li><input name="name" type="submit" value="上传头像" class="submit"/></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="fri-link-bg clearfix">
    <div class="fri-link">
        <div class="logo left margin-r20"><img src="images/fo-logo.jpg" width="152" height="81"/></div>
        <div class="left"><img src="images/qd.jpg" width="90" height="90"/>
            <p>扫描下载APP</p>
        </div>
        <div class="">
            <dl>
                <dt>新手上路</dt>
                <dd><a href="#">售后流程</a></dd>
                <dd><a href="#">购物流程</a></dd>
                <dd><a href="#">订购方式</a></dd>
                <dd><a href="#">隐私声明 </a></dd>
                <dd><a href="#">推荐分享说明 </a></dd>
            </dl>
            <dl>
                <dt>配送与支付</dt>
                <dd><a href="#">保险需求测试</a></dd>
                <dd><a href="#">专题及活动</a></dd>
                <dd><a href="#">挑选保险产品</a></dd>
                <dd><a href="#">常见问题 </a></dd>
            </dl>
            <dl>
                <dt>售后保障</dt>
                <dd><a href="#">保险需求测试</a></dd>
                <dd><a href="#">专题及活动</a></dd>
                <dd><a href="#">挑选保险产品</a></dd>
                <dd><a href="#">常见问题 </a></dd>
            </dl>
            <dl>
                <dt>支付方式</dt>
                <dd><a href="#">保险需求测试</a></dd>
                <dd><a href="#">专题及活动</a></dd>
                <dd><a href="#">挑选保险产品</a></dd>
                <dd><a href="#">常见问题 </a></dd>
            </dl>
            <dl>
                <dt>帮助中心</dt>
                <dd><a href="#">保险需求测试</a></dd>
                <dd><a href="#">专题及活动</a></dd>
                <dd><a href="#">挑选保险产品</a></dd>
                <dd><a href="#">常见问题 </a></dd>
            </dl>
            <dl>
                <dt>帮助中心</dt>
                <dd><a href="#">保险需求测试</a></dd>
                <dd><a href="#">专题及活动</a></dd>
                <dd><a href="#">挑选保险产品</a></dd>
                <dd><a href="#">常见问题 </a></dd>
            </dl>
        </div>
    </div>
</div>
<!--网站地图END-->
<!--网站页脚-->
<div class="copyright">
    <div class="copyright-bg">
        <div class="hotline">为生活充电在线 <span>招商热线：****-********</span> 客服热线：400-******</div>
        <div class="hotline co-ph">
            <p>版权所有Copyright ©***************</p>
            <p>*ICP备***************号 不良信息举报</p>
            <p>总机电话：****-*********/194/195/196 客服电话：4000****** 传 真：********

                <a href="http://www.mycodes.net/" target="_blank">源码之家</a></p>
        </div>
    </div>
</div>
</body>
</html>
